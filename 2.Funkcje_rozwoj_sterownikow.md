# Funkcje i rozwój sterowników [Przetłumaczone]

## Poruszane tematy: [Przetłumaczone]
###  1. Budowa wewnętrzna sterownika
###  2. Zasada pracy sterownika
###  3. Zapis i odczyt danych

## 1. Budowa wewnętrzna sterownika [Przetłumaczone]

### Jednostka PLC składa się z następujących elementów: [Przetłumaczone]
- jednostka centralna (CPU)
- pamięć
- moduły wejścia
- moduły wyjścia
- modył komunikacji
- moduł zasilania

### Jednostka centralna - CPU [Przetłumaczone]
Główny komponent każdego sterownika PLC. Odpowiedzialna za pracę sterownika, prawidłową obsługę modułów rozszerzeń, wykonywanie programu sterującego i komunikację z osobą programującą. 
Najważniejszym elementem jednostki centralnej jest mikroprocesor, którego parametry narzucają możliwości sterownika i jego specyfikację np.:

[Przetłumaczone]
- ilość zmiennych wejściowych i wyjściowych
- maksymalna ilość obsługiwanych modułów rozszerzeń
- szybkość działania sterownika - parametr określający tę wartość wyraża się jako czas cyklu programowego np. jako liczbę wykonywanych instrukcji na jednostkę czas.
- rozmiar pamięci przeznaczonej na dane użytkownika jak i dla programu
- możliwość korzystania z funkcji specjalnych do których należą m.in operacje zmiennoprzecinkowe
- możliwości komunikacyjne np. obsługa funkcji sieci LAN 

### Pamięć [Przetłumaczone]
Element kluczowy do działania CPU. Przechowuje ona program sterujący oraz dane użytkownika.

#### Stosowane rodzaje pramięci [Przetłumaczone]
- RAM - ang. Random Access Memory - stosowana jako pamięć operacyjna, charakteryzuje się dużymi prędkościami odczytu i zapisu. Po odłączeniu zasilania traci swoją zawartość. Z tej przyczyny stosuje się dodatkową baterię, by ta zastąpiła zasilanie gdy go brakuje.
- PROM - ang. Programmable Read Only-Memory - programowalna pamięć służąca jedynie do odczytu. Jej nadpisanie polega na przepaleniu złączy wewnątrz pamięci. Stosuje się matryce oporowe i tranzystorowe. W tych pierwszych oporniki są przepalane na rozwarcie, co oznacza zaprogramowanie zera logicznego. Tranzysotry zaś przepalane są na zwarcie, co jest równoznaczne z zaprogramowaniem jedynki logicznej.
- EEPROM - ang Electrically Erasable Programmable Read-Only Memory - programowalna pamięć służąca do odczytu, którą programuje i wymazuje się elektrycznie. W przeciwieństwie do pamięci typu PROM można ją również nadpisywać. Nie wymaga podtrzymania zasilania jak pamięć typu RAM. Wykorzystywana jako pamięć programu ale równiez jako pamięć do przechowywania kopii zapasowych.
- FLASH EPROM - ang. Flash Erasable Programmable Read-Only Memeory - typ pamięci będący rozwinięciem technologii EEPROM. Stosowana tam, gdzie EEPROM, ale również jako nośnik kopii danych, które można przenosić między sterownikami np. w postaci kart SD.

### Moduły wejścia [Przetłumaczone]
Dzielimy je na cyfrowe i analogowe. Te pierwsze pobierają dane w postaci binarnej (1/0), a te drugie w postaci sygnałów ciągłych np. wartość temperatury, wagi, wychylenia. 

#### Wejścia cyfrowe [Przetłumaczone]
Stanowią kluczowy element interfejsu komunikacji między elementami zewnętrznego systemu sterowania a CPU. Opowiedzialne są za konwersję sygnałów zmiennych lub stałych pochodzących z urządzeń zewnętrznych na sygnały cyfrowe, zrozumiałe dla jednostki centralnej.
Spotyka się moduły zasilane prądem stałym, gdzie najczęściej zeru logicznemu odpowiada 0V, a jedynce 24V, oraz zasilane prądem przemiennym, które poziom logiczny dostosowują do wartości napięcia sieci energetycznej.
Często spotyka się zastosowanie separacji galwanicznej (tj. rozwiązanie, w którym prąd z jednego bloku elektrycznego nie przepływał bezpośrenio do drugiego bloku) między układami zewnętrznymi a główną magistralą sterownika PLC. W tym celu stosuje się transportery dla prądu stałego i optoizolatory dla prądu przemiennego.

#### Wejścia analogowe [Przetłumaczone]
Ich zadaniem jest tłumaczenie otrzymanych sygnałów analogowych na sygnały cyfrowe, zrozumiałem przez jednostkę centralną. Głównym elementem tego modułu jest przetownik analogowo-cyfrowy, przekazujący dalej dyskretną postać odebranego sygnału wejściowego. Dokonuje on kwantyzacji najczęściej na 16 bitach. Często spotykanymi rozdzielczościami takiego przetwornika to od 12 do 16 bitów.
Stosuje się wiele sygnałów analogowych. Oto kilka przykładów:
- ###### sygnały napięciowe np. 0 - 10V, 1 - 5V, -10 - +10V
- ###### sygnały prądowe np. 0 - 20mA, 4 - 20mA
- ###### sygnał pomiaru rezystancji

### Moduły wyjścia
Podobnie jak wejścia, dzielimy je ze względu na rodzaj danych, które z nich można otrzymać - cyfrowe i analogowe. Służą do sterowania urządzeniami wykonawczymi automatyki np. styki, regulatory, elektrozawory, układy kontrolne.

#### Wyjścia cyfrowe
Służą do wyprowadzania sygnałów w postaci dyskretnej do zewnętrznych obwodów urządzeń wykonwaczych. Najczęściej podłączane są do przełączników bądź styczników, które są odpowiedzialne za działanie urządzeń/modułów zewnętrznych.
Rozróżniamy dwie grupy wyjść cyfrowych ze względu na rodzaj elementu sterującego wyjścia:

- ###### Wyjścia przekaźnikowe
Posiadają wyprowadzenia dla styków przekaźników normalnie otwartych i zamkniętych, których celem jest załączanie i rozłączanie zewnętrznych układów elektrycznych.

- ###### Wyjścia półprzewodnikowe
Zamiast styków stosuje się w nich tranzystory dla układów prądu stałego i tyrystory lub triaki dla układów prądu zmiennego. Pełnią tę samą funkcję co przekaźniki, ale mają nad nimi znaczącą przewagę w postaci szybkości działania i wytrzymałości, jak i podczas pracy nie emitują żadnych dźwięków.


#### Wyjścia analogowe


### Moduł komunikacji

Moduł komunikacji ma za zadanie sprzęganie innych urządzeń ze sterownikiem poprzez wymianę danych między nimi. Do takiej komunikacji wykorzystuje się przemysłową sieć komunikacyjną.
Przykłady urządzeń, z którymi może komunikować się sterownik:

- inne sterowniki PLC, w tym te pracujące w trybie redundantnym
- czujniki i przetworniki pomiarowe, czujniki inteligentne
- urządzenia wykonawce wyposażone we własne interfejsy komunikacyjne
- systemy sterowania nadrzędnego
- urządzenie HMI (Human-Machine Interface) np. pulpity sterownicze, wyświetlacze, diody informacyjne


### Moduł zasilania
Element odpowiedzialny za dostarczenie energii niezbędnej do pracy sterownika. Może stanowić osobną część, ale również spotyka się zasilacze zintegraowne w obudowie sterownika. Stosuje się na ogół układy przystosowane do zasilania napięciem stałym 24V, ale również spotykane są konstrukcje mogące zasilać sterownik bezpośrednio z sieci energetycznej o napięciu zmiennym 230V lub 110V (zalezy to od systemu energetycznego kraju).
Jako zasilacz często stosuje się zasilacze impulsowe, które charakteryzują się następującymi cechami:
- dużą stabilizacją napięcia wyjściowego
- wysoką sprawnością przetwornicy napięcia zmiennego na napięcie stałe
- dużą mocą w stosunku do małych gabarytów
- wbudowanymi zabezpieczeniami zapobiegającymi przepięciom i przeciążeniom
- spełnianiem wielu norm, pozwalającym na pracę w trudnych warunkach jak i kompatybilność elektromagnetyczną

Zasilacze stosowane w sterownikach są często dedykowane do projektowanych konstrukcji, przez co ich koszt jest dość spory.

## 2. Zasada pracy sterownika

Każdy sterownik PLC działa na zasadzie ciagłego zapętlania sekwencji rozkazów zapisanych w jego pamięci, nazywanych cyklem.
Pojedynczy rozkaz jest najmniejszą częścią programu sterującego i składa się z operacji określającej rodzaj wykonywanej funkcji oraz argumentów określających sygnały wejściowe i wyjściowe sterownika powiązanych ze sobą funkcjami logicznymi. Rozkazy te są przetwarzane przez system mikroprocesorowy sterownika, który na ich podstawie wykonuje odpowiednie działanie, takie jak: operacje logiczne, operacje arytmetyczne, odczyt i zapis danych z/do pamięci.

### Etapy cyklu pracy sterownika:

##### 1. Inicjalizacja sterowania
##### 2. Odczyt sygnałów wejściowych sterownika
##### 3. Wykonanie zadania sterownika - programu
##### 4. Zapis danych wyjściowych sterownika
##### 5. Obsługa komunikacji
##### 6. Autodiagnostyka

### 1. Inicjalizacja sterowania
Na tym etapie sterownik wykonuje czynności niezbędne do rozpoczęcia pracy, w tym sprawdza poprawność działania swoich obwodów wewnętrznych oraz konfigurację sprzętową podzespołów i modułów rozszerzeń. W przeciwieństwie do innych etapów, które powtarzają się za każdą iteracją pętli, ten jest wykonywany tylko raz.

### 2. Odczyt sygnałów wejściowych sterownika
Sterownik odczytuje stany wszystkich wejść, zapisuje ich wartość w specjalnie wydzielonym miejscu w pamięci, nazywanym obrazem wejść procesu PII (ang. Process-Image Input).

### 3. Wykonanie zadania sterownika - programu
W tej fazie przetwarzany jest program użytkownika. Na jego podstawie wykonywane są określone działania. Wszytskie polecenia wykonywane są w sekwencji, jedno po drugim. Uniemożliwia to wykonanie dwóch czynności na raz. Zapisywane są również wyniki obliczeń w pamięci danych. Po wykonaniu wszystkich poleceń zostaje wygenerowany nowy stan wyjść, który jest zapisywany do specjalnego miejsca w pamięci, nazywanego obrazem wyjść procesy PIO (ang. Process-Image Output).

Wykonanie programu trwa pewien czas zależny od parametrów i długości programu (kilka do kilkuset milisekund). W najgorszym przypadku opóźnienie wnoszone przez sterownik może osiągnąć do 2 cykli sterownika.

Należy zwrócić uwagę na przypisywanie wartości do zmiennych wyjściowych. Proces ten powinien występować w kodzie tylko raz z uwagi na fakt, że wartości zmiennych będą zależały tylko od ostatnio wykonanej instrukcji przypisania.

### 4. Zapis danych wyjściowych sterownika
Następuje pobranie wartości stanu wyjść z PIO oraz zostaje on zapisany do fizycznych portów wyjściowych urządzenia. Wyjścia zostają uaktualnione i przyjmują wartość wyliczoną na podstawie programu sterującego. Aktualizaja następuje tylko raz w danym cyklu pracy.

### 5. Obsługa komunikacji
Ta faza sytępuje tylko, gdy wykorzystywana jest komunikacja sieciowa z innymi urządzeniami zewnętrznymi np. inne sterowniki, panele operatorskie.
Następuje dwukierunkowa transmisja danych oraz obsługa programatora np. komputera przekazującego komendy sterujące takich jak przełączenie trybu pracy, odczyt/zapis programu.

### 6. Autodiagnostyka
Sterownik przeprowadza testy autodiagnostyczne, aby monitorować swój stan i wykrywać ewentualne awarie. Sprawdza on między innymi:
- temperaturę podzespołów
- napięcie zasilania systemu
- obciążenie procesora
- pojawianie się błędów logicznych podczas realizacji programu
- interfejsy komunikacyjne, modułów wejściowych/wyjściowych oraz pamięć

Przy wykryciu problemów sterownik zgłasza błąd użytkownikowi lub systemowi nadzorującemu poprzez komunikaty lub diody. Podejmuje on następnie działania naprawcze takie jak niezwłoczne zatrzymanie, uniemożliwiające niekontrolowane załączanie urządzeń wykonawczych lub przejście w tryb awaryjny, w którym podejmuje ograniczone decyzje.

## 3. Zapis i odczyt danych

źródła:
- Marcin Pawlak - Serowniki programowalen
- Jacek Barański - Separacja galwaniczna w nowoczesnych przyrządach i systemach pomiarowych\
- Marcin Kielczewski - Sterowniki PLC
- https://pl.wikipedia.org/wiki/Pami%C4%99%C4%87_flash 
- https://pl.wikipedia.org/wiki/Zasilacz_impulsowy
- https://www.ebmia.pl/wiedza/porady/automatyka-porady/sterownik-plc-budowa-rodzaje-zastosowanie/
- http://www.pkeopk.sep.com.pl/jurata2008/Baranski_Separacja.pdf
- https://polskiprzemysl.com.pl/utrzymanie-ruchu/co-to-jest-sterownik-plc/
- https://www.astor.com.pl/poradnikautomatyka/wszystko-o-hmi-co-automatyk-powinien-wiedziec/
- dr inż. Jarosław Tarnawski - Sterowniki programowalne - System GE Fanuc serii 90-30, Zasada działania systemu https://eia.pg.edu.pl/documents/184139/29070092/W3%20-%20Wyk%C5%82ad%20SP%20-%20PLC1.pdf

# Proponuję pisać wersję angielską niżej, a dopiero na koniec usunąć wersję polską

# Facilities and development of programmable logic controllers

## Topics:

### 1. PLC internal structure
### 2. Working pronciple of the controller
### 3. Writing and reading of data

## 1. PLC internal structure

### PLC consists of the following components:
- central processing unit
- memory
- input module
- output module
- power supply unit

### Central processing unit

The main component of any PLC. It is responsible for the operation of the controlle, proper operation of expansion modules, execution of the program and communication with the programmer.
The most importatn component of the central unit is the microprocessor, whose parameters dictate the capabilities of the controller itself and its specification e.g.:

- number of input and output variables
- the maximum number of expansion modules supported
- the speed of the controller - the parameter determining this value is expressed as the time of the program cycle, e.g. as the number of executed instructions per unit time.
- the size of the memory allocated for user data and for the program
- possibility of using special functions, which include floating point operations
- communication capabilities, e.g. support for LAN functions

### Memory
A key element for the operation of the CPU. It stores the control program and user data.

#### Applied types of memory 
- RAM - Random Access Memory - used as operational memory, it is characterized by high read and write speeds. When the power is disconnected, it loses all stored data. For this reason, an additional battery is used to replace the power supply when it is missing or turned off.
- PROM - Programmable Read-Only Memory - its overwriting involves burning through the connectors inside the memory. Resistor arrays and transistor arrays are used. In the former, resistors are burned to open, which means programming a logic zero. Transistors, on the other hand, are burned into a short circuit, which is equivalent to programming a logical one.
- EEPROM - Electrically Erasable Programmable Read-Only Memory - programmable read-only memory that is programmed and erased electrically. Unlike PROM-type memory, it can also be overwritten. It does not require power supply like RAM type memory. Used as program memory but also as backup storage.
- FLASH EPROM - Flash Erasable Programmable Read-Only Memory - a type of memory that is a development of EEPROM technology. Used where EEPROM, but also as a storage medium for copies of data that can be transferred between controllers, for example, in the form of SD cards.

### Input modules
They are divided into digital and analog types. The former take data in binary form (1/0), and the second in the form of continuous signals, e.g. temperature value, weight, tilt. 

### Input modules
They are divided into digital and analog types. The former take data in binary form (1/0), and the second in the form of continuous signals, e.g. temperature value, weight, tilt. 

#### Digital inputs
They are a key part of the communication interface between the components of the external control system and the CPU. They are responsible for converting variable or continuous signals from external devices into digital signals understood by the CPU.
One encounters DC-powered modules, where most often the logic zero corresponds to 0V and the logic one to 24V, and AC-powered ones, which adjust the logic level to the voltage value of the power grid.
It is common to find the use of galvanic separation (i.e., a solution in which the current from one electrical block does not flow directly to another block) between external circuits and the main bus of the PLC. For this purpose, transporters are used for direct current and optoisolators for alternating current.

#### Analog inputs
Their task is to translate received analog signals into digital version, understood by the central unit. The main component of this module is an analog-to-digital converter, which passes on the discrete form of the received input signal. It performs quantization most often on 16 bits. Common resolutions of such a converter are from 12 to 16 bits.
Many analog signals are used. Here are some examples:
- ###### voltage signals e.g. 0 - 10V, 1 - 5V, -10 - +10V
- ###### current signals e.g. 0 - 20mA, 4 - 20mA
- ###### resistance measurement signal

### Output modules
Similar to inputs, they are divided according to the type of data that can be obtained from them - digital and analog. They are used to control autoambient actuators, e.g. contacts, regulators, solenoid valves, control systems.

#### Digital outputs
They are used to output signals in discrete form to external circuits of executive devices. Most often they are connected to switches or contactors, which are responsible for the operation of external devices/modules.
We distinguish two groups of digital outputs due to the type of output control element:

- ###### Relay outputs
They have outputs for normally open and closed relay contacts, the purpose of which is to switch on and off external electrical systems.

- ###### Solid-state outputs
Instead of contacts, they use transistors for DC systems and thyristors or triacs for AC systems. They perform the same function as relays, but have a significant advantage over them in terms of speed of operation and durability, as well as making no noise during operation.
